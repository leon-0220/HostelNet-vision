<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Registered Students</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body { margin:0; padding:0; font-family: Arial, sans-serif; }
    .layout { display:flex; min-height:100vh; }
    .sidebar { width:220px; background:#fff3e0; color:#3e2723; padding:20px; position:fixed; top:0; left:0; height:100vh; overflow-y:auto; transition:transform 0.3s ease; }
    .sidebar.closed { transform:translateX(-100%); }
    .logo-box { display:flex; flex-direction:column; align-items:center; margin-bottom:20px; }
    .logo-box img { width:100%; max-width:160px; margin-bottom:5px; }
    .sidebar ul { list-style:none; padding:0; margin:0; }
    .sidebar ul li { margin:8px 0; }
    .sidebar ul li a { color:#3e2723; text-decoration:none; display:block; padding:8px 12px; border-radius:5px; transition:0.3s; }
    .sidebar ul li a:hover { background:#ed5d2d; color:#fff; }
    .main-content { flex:1; margin-left:220px; padding:20px; background:linear-gradient(180deg,#ff4000,#eef3f8); transition:margin-left 0.3s ease; }
    .main-content h2 { text-align:center; color:#000; margin-bottom:20px; }
    .student-card { transition:transform 0.2s, box-shadow 0.2s; border-radius:12px; }
    .student-card:hover { transform:translateY(-5px); box-shadow:0 6px 12px rgba(0,0,0,0.15); }
    .student-card img { border-radius:50%; margin-bottom:10px; }
    .toggle-btn { position:fixed; top:15px; left:15px; background:#fff3e0; border:none; cursor:pointer; padding:8px 12px; border-radius:5px; z-index:1100; }
    .sidebar.closed ~ .main-content { margin-left:0; }
    .btn-primary { background-color:orange !important; border-color:orange !important; color:white !important; }
    .btn-primary:hover { background-color:darkorange !important; }
  </style>
</head>
<body>
  <div class="layout">
    <div class="sidebar" id="sidebar">
      <div class="logo-box">
        <img src="../images/2.png" alt="Vision University College Logo">
        <h3>Menu</h3>
      </div>
      <ul>
        <li><a href="dashboard2.html">ğŸ  Dashboard</a></li>
        <li><a href="registered_students.html">ğŸ‘¨â€ğŸ“ Registered Students</a></li>
        <li><a href="warden_profile.html">ğŸ‘©â€ğŸ« Warden</a></li>
        <li><a href="maintenance_profile.html">ğŸ›  Maintenance</a></li>
        <li><a href="finance_profile.html">ğŸ’³ Finance</a></li>
        <li><a href="logout.html" style="color:#ffdddd;">ğŸšª Logout</a></li>
      </ul>
    </div>

    <button class="toggle-btn" onclick="toggleSidebar()">â˜°</button>

    <div class="main-content">
      <h2>Registered Students</h2>
      <input type="text" id="searchInput" class="form-control mb-4" placeholder="Search student by name...">
      <div class="row" id="studentGrid"></div>
    </div>
  </div>

  <script>
    function toggleSidebar() {
      document.getElementById("sidebar").classList.toggle("closed");
    }

    async function loadStudents() {
      try {
        const res = await fetch("/api/registered-students");
        const students = await res.json();
        const grid = document.getElementById("studentGrid");
        grid.innerHTML = "";

        students.forEach(s => {
          grid.innerHTML += `
            <div class="col-md-4 mb-3">
              <div class="card student-card p-3 text-center">
                <img src="../images/student1.png" width="80" height="80">
                <h5 class="card-title">${s.name}</h5>
                <p class="card-text">${s.program || "N/A"}</p>
                <small>Room: ${s.room_number || "Not Assigned"}</small><br>
                <a href="student_profile.html?id=${s.id}" class="btn btn-primary btn-sm mt-2">View Profile</a>
              </div>
            </div>`;
        });
      } catch (err) {
        console.error("Error loading students:", err);
      }
    }

    document.getElementById("searchInput").addEventListener("keyup", function() {
      const filter = this.value.toLowerCase();
      document.querySelectorAll(".student-card").forEach(card => {
        const name = card.querySelector(".card-title").innerText.toLowerCase();
        card.parentElement.style.display = name.includes(filter) ? "block" : "none";
      });
    });

    loadStudents();
  </script>
</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Student Dashboard - Hostel Management System</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../../css/studentstyle.css">
</head>
<body>
  <!-- Sidebar -->
  <div class="sidebar" id="sidebar">
    <div class="logo-box">
      <img src="../../images/vision.png" alt="Vision University College Logo">
      <h4 class="mb-4">HostelNet</h4>
    </div>
    <ul class="nav flex-column">
      <li><a href="dashboard.html">ğŸ  Home</a></li>
      <li><a href="profile.html">ğŸ‘¨â€ğŸ“ My Profile</a></li>
      <li><a href="registration.html">ğŸ› Online Registration</a></li>
      <li><a href="studentroom.html">ğŸ’³ Room Selection</a></li>
      <li><a href="checkin.html">ğŸ“ Check-in</a></li>
      <li><a href="checkout.html">ğŸ“ Check-out</a></li>
      <li><a href="../../logout.html">ğŸšª Logout</a></li>
    </ul>
  </div>

  <button class="toggle-btn" onclick="toggleSidebar()">â˜°</button>

  <div class="main-content">
    <div class="container-fluid p-4">
      <h2 class="mb-4">Student Profile</h2>

      <!-- Profile Section -->
      <div class="card mb-4">
        <div class="card-header profile-header">My Profile</div>
        <div class="card-body">
          <p><strong>Name:</strong> <span id="studentName">Loading...</span></p>
          <p><strong>Student ID:</strong> <span id="studentID">Loading...</span></p>
          <p><strong>Course:</strong> <span id="studentCourse">Loading...</span></p>
          <p><strong>Hostel Unit:</strong> <span id="hostelUnit">Loading...</span></p>
          <p><strong>Room Number:</strong> <span id="roomNumber">Loading...</span></p>
        </div>
      </div>

      <!-- Hostel Information -->
      <div class="card mb-4">
        <div class="card-header hostel-header">Hostel Information</div>
        <div class="card-body">
          <ul>
            <li>Check-in Date: <span id="checkIn">Loading...</span></li>
            <li>Check-out Date: <span id="checkOut">Loading...</span></li>
            <li>Status: <span id="status">Loading...</span></li>
          </ul>
        </div>
      </div>

      <!-- Notices -->
      <div class="card mb-4">
        <div class="card-header info-header">Latest Notices</div>
        <div class="card-body">
          <ul>
            <li>âš  Hostel maintenance will be on 15 Sept 2025</li>
            <li>ğŸ“¢ Fire drill practice scheduled on 20 Sept 2025</li>
            <li>ğŸ“Œ Payment deadline for Semester 6: 30 Sept 2025</li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <script src="../../js/studentscript.js"></script>
  <script>
    function toggleSidebar() {
      document.getElementById("sidebar").classList.toggle("closed");
    }

    // Ambil student_id dari localStorage
    const studentID = localStorage.getItem("user_id"); 
    if (!studentID) {
      alert("âŒ Not logged in!");
      window.location.href = "../../index.html";
    }

    // Fetch student details dari backend
    async function loadStudentProfile() {
      try {
        const res = await fetch(`https://hostelnet-vision-3.onrender.com/api/students/${studentID}`);
        if (!res.ok) throw new Error("Failed to fetch student data");

        const data = await res.json();

        // Update HTML
        document.getElementById("studentName").textContent = data.name;
        document.getElementById("studentID").textContent = data.student_id;
        document.getElementById("studentCourse").textContent = data.course;
        document.getElementById("hostelUnit").textContent = data.hostel_unit;
        document.getElementById("roomNumber").textContent = data.room_number;
        document.getElementById("checkIn").textContent = data.check_in_date;
        document.getElementById("checkOut").textContent = data.check_out_date;
        document.getElementById("status").textContent = data.status;

      } catch (error) {
        console.error(error);
        alert("âš  Unable to load student profile.");
      }
    }

    loadStudentProfile();
  </script>
</body>
</html>